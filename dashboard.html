<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OddMax VIP - Dashboard de Elite</title>
  
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

  <style>
    :root {
      --primary: #7d33ff;
      --primary-bright: #a166ff;
      --bg: #05070a;
      --card-bg: #111418;
      --border: #1f242c;
      --green: #2ecc71;
      --red: #ff4757;
      --live: #ff4757; 
      --whatsapp: #25d366;
      --gradient: linear-gradient(135deg, #7d33ff 0%, #3a11ff 100%);
    }

    /* --- AJUSTES PARA CELULAR --- */
    @media (max-width: 768px) {
      .sidebar { position: fixed; z-index: 1001; height: 100%; }
      .top-bar { flex-wrap: wrap; gap: 10px !important; }
      .calc-topbar { order: 3; width: 100%; justify-content: space-between; overflow-x: auto; font-size: 9px; }
      .search-container input { width: 120px !important; }
      .welcome-card h1 { font-size: 2rem !important; }
      .content-scroll { padding: 10px !important; }
      .card { padding: 15px !important; }
    }

    /* --- ESTILOS ORIGINAIS --- */
    .rodada-container { width: 100%; max-width: 650px; margin-bottom: 15px; }
    
    .rodada-header {
      width: 100%; background: var(--card-bg); border: 1px solid var(--primary); 
      color: white; padding: 18px; border-radius: 15px; cursor: pointer; 
      display: flex; justify-content: space-between; align-items: center;
      font-weight: 900; text-transform: uppercase; letter-spacing: 1px;
      transition: 0.3s;
    }
    .rodada-header:hover { background: rgba(125, 51, 255, 0.1); }
    
    .rodada-content { display: none; flex-direction: column; align-items: center; padding-top: 20px; width: 100%; }

    .analise-expansivel {
      max-height: 0; overflow: hidden;
      transition: max-height 0.4s ease-in-out, opacity 0.3s; opacity: 0;
    }
    .analise-expansivel.show {
      max-height: 1000px; opacity: 1; margin-top: 15px; padding-top: 15px;
      border-top: 1px solid rgba(125, 51, 255, 0.2);
    }
    .btn-toggle-analise {
      width: 100%; background: rgba(125, 51, 255, 0.05); border: 1px solid var(--border);
      color: var(--primary-bright); padding: 10px; border-radius: 12px;
      cursor: pointer; font-size: 11px; font-weight: 800;
      text-transform: uppercase; margin-top: 10px; transition: 0.3s;
      display: flex; justify-content: center; align-items: center; gap: 8px;
    }

    #notification-container { position: fixed; top: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
    .toast-alert {
      background: var(--card-bg); border: 1px solid var(--primary); border-left: 5px solid var(--primary);
      padding: 15px 25px; border-radius: 12px; color: white;
      box-shadow: 0 10px 30px rgba(0,0,0,0.8); animation: slideIn 0.5s ease forwards; min-width: 300px;
    }

    @keyframes slideIn { from { transform: translateX(120%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    .toast-alert.fade-out { animation: slideOut 0.5s ease forwards; }
    @keyframes slideOut { from { transform: translateX(0); opacity: 1; } to { transform: translateX(120%); opacity: 0; } }

    body {
      background-color: var(--bg); background-image: radial-gradient(circle at 50% -20%, #1e104a, transparent);
      color: #f0f6fc; margin: 0; font-family: 'Inter', sans-serif; display: flex; height: 100vh; overflow: hidden;
    }

    /* --- SIDEBAR AJUSTADA (ITENS LADO A LADO) --- */
    .sidebar { width: 280px; background: #090b0f; border-right: 1px solid var(--border); display: flex; flex-direction: column; flex-shrink: 0; transition: all 0.3s ease; overflow: hidden; z-index: 1000; }
    .sidebar.closed { width: 0; border-right: none; }
    
    .sidebar-header { 
      padding: 30px 20px; 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      border-bottom: 1px solid var(--border); 
      white-space: nowrap; 
    }
    .sidebar-header h2 { margin: 0; font-size: 1.4rem; color: #fff; font-weight: 900; letter-spacing: 2px; }
    
    .btn-close-sidebar { background: none; border: none; color: white; font-size: 24px; cursor: pointer; display: flex; align-items: center; }

    .sidebar-menu { flex: 1; overflow-y: auto; padding: 15px; min-width: 280px; }
    .menu-label { font-size: 11px; color: var(--primary-bright); font-weight: 800; margin: 25px 0 10px 10px; text-transform: uppercase; letter-spacing: 1px; }

    .camp-btn {
      width: 100%; background: transparent; color: #8b949e; border: none; padding: 10px 15px; border-radius: 8px; margin-bottom: 3px;
      text-align: left; cursor: pointer; font-weight: 600; transition: 0.2s; display: flex; align-items: center; gap: 10px;
    }
    .camp-btn:hover { background: rgba(255,255,255,0.05); color: white; }
    .camp-btn.active { color: white; background: var(--gradient); box-shadow: 0 4px 12px rgba(125, 51, 255, 0.3); }

    .main-content { flex: 1; display: flex; flex-direction: column; width: 100%; min-width: 0; position: relative; }
    .top-bar { padding: 10px 20px; background: rgba(17, 20, 24, 0.9); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 20px; min-height: 65px; }
    
    /* BOT√ÉO REOPEN E ESPA√áAMENTO DA BUSCA */
    .btn-reopen { 
      position: fixed; top: 15px; left: 15px; z-index: 999; background: var(--card-bg); border: 1px solid var(--primary); 
      color: white; padding: 8px 12px; border-radius: 8px; cursor: pointer; display: none; font-weight: bold;
    }
    .sidebar.closed ~ .main-content .btn-reopen { display: block; }
    .sidebar.closed ~ .main-content .search-container { margin-left: 85px; } /* Ajuste de espa√ßamento aqui */

    .search-container { display: flex; align-items: center; gap: 10px; transition: margin-left 0.3s ease; }
    .search-container input { width: 180px; background: #0d1117; border: 1px solid var(--border); padding: 10px 15px; border-radius: 10px; color: white; outline: none; }

    .filter-bar { display: flex; gap: 10px; padding: 15px 30px; background: rgba(0,0,0,0.2); width: 100%; box-sizing: border-box; overflow-x: auto; }
    .filter-tag { padding: 6px 15px; border-radius: 12px; font-size: 10px; font-weight: 800; cursor: pointer; border: 1px solid var(--border); color: #8b949e; transition: 0.2s; text-transform: uppercase; white-space: nowrap; }
    .filter-tag.active { background: var(--primary); color: white; border-color: var(--primary); }

    .calc-topbar { display: flex; align-items: center; gap: 10px; background: #161b22; padding: 5px 15px; border-radius: 12px; border: 1px solid var(--border); }
    .calc-topbar input { width: 60px; background: #05070a; border: 1px solid var(--primary); padding: 5px; border-radius: 5px; color: white; text-align: center; }
    .calc-result { font-size: 10px; font-weight: bold; line-height: 1.2; text-align: center; }
    .calc-result span { color: var(--green); display: block; }

    .content-scroll { flex: 1; padding: 10px 30px 30px 30px; overflow-y: auto; display: flex; flex-direction: column; align-items: center; }
    .welcome-card { width: 100%; max-width: 750px; background: linear-gradient(180deg, rgba(125, 51, 255, 0.1) 0%, rgba(5, 7, 10, 0.9) 100%); border: 1px solid rgba(125, 51, 255, 0.3); padding: 60px 30px; border-radius: 30px; text-align: center; margin-bottom: 40px; box-shadow: 0 20px 50px rgba(0,0,0,0.6); box-sizing: border-box; }
    .welcome-card h1 { font-size: 3.2rem; margin: 0; font-weight: 900; color: #ffffff; text-transform: uppercase; }
    .welcome-card h1 span { color: #7d33ff; text-shadow: 0 0 20px rgba(125, 51, 255, 0.8); }

    .card { width: 100%; max-width: 650px; background: var(--card-bg); border: 1px solid rgba(125, 51, 255, 0.3); border-radius: 24px; padding: 25px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); box-sizing: border-box; }
    .entrada-box { background: #0d1117; border-left: 6px solid var(--primary); padding: 20px; border-radius: 15px; margin: 20px 0; }
    .radar-bar-bg { width: 100%; height: 8px; background: rgba(255,255,255,0.05); border-radius: 10px; overflow: hidden; margin-top: 8px; }
    .radar-bar-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--green)); border-radius: 10px; transition: width 1s ease; }

    .btn-suporte { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background-color: var(--whatsapp); border-radius: 50%; display: flex; justify-content: center; align-items: center; z-index: 1000; animation: pulse-green 2s infinite; cursor: pointer; }
    @keyframes pulse-green { 0% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(37, 211, 102, 0); } 100% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0); } }
  </style>
</head>
<body>

  <div id="notification-container"></div>

  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h2>OddMax VIP</h2>
      <button class="btn-close-sidebar" onclick="toggleSidebar()">‚ò∞</button>
    </div>
    <div class="sidebar-menu">
        <div class="menu-label">üáßüá∑ Brasil Nacional</div>
        <button class="camp-btn" onclick="filtrarCamp('Brasileir√£o S√©rie A', this)">‚öΩ Brasileir√£o S√©rie A</button>
        <button class="camp-btn" onclick="filtrarCamp('Brasileir√£o S√©rie B', this)">‚öΩ Brasileir√£o S√©rie B</button>
        <button class="camp-btn" onclick="filtrarCamp('Copa do Brasil', this)">üèÜ Copa do Brasil</button>

        <div class="menu-label">üèÜ Estaduais</div>
        <button class="camp-btn" onclick="filtrarCamp('Paulista', this)">üèüÔ∏è Paulista</button>
        <button class="camp-btn" onclick="filtrarCamp('Carioca', this)">üèüÔ∏è Carioca</button>
        <button class="camp-btn" onclick="filtrarCamp('Mineiro', this)">üèüÔ∏è Mineiro</button>
        <button class="camp-btn" onclick="filtrarCamp('Ga√∫cho', this)">üèüÔ∏è Ga√∫cho</button>

        <div class="menu-label">üá™üá∫ Principais Europeus</div>
        <button class="camp-btn" onclick="filtrarCamp('Premier League', this)">üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø Premier League</button>
        <button class="camp-btn" onclick="filtrarCamp('La Liga', this)">üá™üá∏ La Liga</button>
        <button class="camp-btn" onclick="filtrarCamp('Bundesliga', this)">üá©üá™ Bundesliga</button>
        <button class="camp-btn" onclick="filtrarCamp('Ligue 1', this)">üá´üá∑ Ligue 1</button>
        <button class="camp-btn" onclick="filtrarCamp('Serie A It√°lia', this)">üáÆüáπ Serie A</button>

        <div class="menu-label">üåé Copas Internacionais</div>
        <button class="camp-btn" onclick="filtrarCamp('Libertadores', this)">üèÜ Libertadores</button>
        <button class="camp-btn" onclick="filtrarCamp('Sulamericana', this)">üèÜ Sulamericana</button>
        <button class="camp-btn" onclick="filtrarCamp('Copa do Mundo', this)">üåç Copa do Mundo</button>
        <button class="camp-btn" onclick="filtrarCamp('Amistosos', this)">ü§ù Amistosos</button>
        
        <button class="camp-btn" onclick="limparFiltros()" style="margin-top:25px; color: var(--primary); justify-content: center;">üîÑ VOLTAR AO IN√çCIO</button>
    </div>
  </aside>

  <main class="main-content">
    <button class="btn-reopen" onclick="toggleSidebar()">‚ò∞ Menu</button>

    <div class="top-bar">
      <div class="search-container">
        <input type="text" id="inputBusca" onkeyup="filtrarGeral()" placeholder="üîç Buscar jogo...">
      </div>
      <div class="calc-topbar">
        <span style="font-size: 11px; font-weight: bold; color: var(--primary-bright);">BANCA R$</span>
        <input type="number" id="bancaValor" placeholder="Ex: 100" oninput="calcularStake()">
        <div class="calc-result">10% <span id="stake10">R$ 0,00</span></div>
        <div class="calc-result">15% <span id="stake15">R$ 0,00</span></div>
        <div class="calc-result">20% <span id="stake20">R$ 0,00</span></div>
        <div class="calc-result">30% <span id="stake30">R$ 0,00</span></div>
        <div class="calc-result">40% <span id="stake40">R$ 0,00</span></div>
        <div class="calc-result">50% <span id="stake50">R$ 0,00</span></div>
      </div>
      <div style="margin-left: auto; display: flex; gap: 10px;">
        <input type="date" id="inputData" onchange="filtrarGeral()" style="background:#1a1d23; border:1px solid var(--primary); color:white; border-radius:8px; padding:5px;">
        <button style="background:transparent; color:#ff4757; border:1px solid #ff4757; padding:5px 12px; border-radius:8px; cursor:pointer; font-weight:bold;" onclick="logout()">SAIR</button>
      </div>
    </div>

    <div class="filter-bar">
        <div class="filter-tag active" id="filter-todos" onclick="filtrarStatus('TODOS', this)">üìä Todos</div>
        <div class="filter-tag tag-live" id="filter-ao-vivo" onclick="filtrarStatus('AO VIVO', this)">üì° Ao Vivo</div>
        <div class="filter-tag tag-green" id="filter-green" onclick="filtrarStatus('GREEN', this)">‚úÖ Greens</div>
        <div class="filter-tag tag-red" id="filter-red" onclick="filtrarStatus('RED', this)">‚ùå Reds</div>
    </div>

    <div class="content-scroll">
      <div id="welcome-message" class="welcome-card">
        <h1>BEM-VINDO AO <span>ODDMAX VIP</span></h1>
        <p>A sua central de intelig√™ncia esportiva est√° pronta. Analisamos milhares de dados para entregar apenas o que realmente tem valor.</p>
        <div class="status-tags">
            <span class="tag">‚úÖ SISTEMA ONLINE</span>
            <span class="tag">üíé DADOS ELITE</span>
            <span class="tag">üöÄ ALTA PRECIS√ÉO</span>
        </div>
      </div>
      <div id="lista-palpites" style="width:100%; display:flex; flex-direction:column; align-items:center;"></div>
    </div>
  </main>

  <a href="https://wa.me/5511986652226" target="_blank" class="btn-suporte">
    <svg viewBox="0 0 448 512" style="width:30px; fill:white;"><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-5.5-2.8-23.2-8.5-44.2-27.1-16.4-14.6-27.4-32.7-30.6-38.1-3.2-5.5-.3-8.5 2.4-11.2 2.5-2.4 5.5-6.5 8.3-9.7 2.8-3.3 3.7-5.5 5.5-9.3 1.9-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 13.2 5.8 23.5 9.2 31.5 11.8 13.3 4.2 25.4 3.6 35 2.2 10.7-1.5 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
  </a>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyACqz98WONOsFwK9mP2udGfYI6a7H8bwO0",
      authDomain: "oddmax-2004b.firebaseapp.com",
      projectId: "oddmax-2004b",
      storageBucket: "oddmax-2004b.firebasestorage.app",
      messagingSenderId: "317240346694",
      appId: "1:317240346694:web:e551215b1cf64d58246247"
    };

    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    let todosPalpites = [];
    let campSelecionado = "";
    let statusFiltro = "TODOS";
    let isFirstLoad = true;

    auth.onAuthStateChanged((user) => {
      if (user) { carregarDashboard(); } else { window.location.href = "login.html"; }
    });

    function carregarDashboard() {
        db.collection('palpites').orderBy('criadoEm', 'desc').onSnapshot((snap) => {
            if (!isFirstLoad) {
                snap.docChanges().forEach(change => {
                    if (change.type === "added") {
                        const p = change.doc.data();
                        showNotification(p.jogo, p.entrada);
                    }
                });
            }
            todosPalpites = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            filtrarGeral();
            isFirstLoad = false;
        });
    }

    function filtrarGeral() {
        const busca = document.getElementById('inputBusca').value.toLowerCase();
        const data = document.getElementById('inputData').value;
        const container = document.getElementById('lista-palpites');
        container.innerHTML = '';

        if (!busca && !data && !campSelecionado) {
            document.getElementById('welcome-message').style.display = 'block';
            return;
        } else {
            document.getElementById('welcome-message').style.display = 'none';
        }

        const filtrados = todosPalpites.filter(p => {
            const matchBusca = p.jogo ? p.jogo.toLowerCase().includes(busca) : true;
            const matchData = data ? p.data_jogo === data : true;
            const matchCamp = campSelecionado ? p.campeonato === campSelecionado : true;
            const matchStatus = statusFiltro === "TODOS" ? true : (p.status === statusFiltro);
            return matchBusca && matchData && matchCamp && matchStatus;
        });

        const rodadasAgrupadas = {};
        filtrados.forEach(p => {
            const numR = p.rodada || "1";
            if (!rodadasAgrupadas[numR]) rodadasAgrupadas[numR] = [];
            rodadasAgrupadas[numR].push(p);
        });

        Object.keys(rodadasAgrupadas).sort((a,b) => b-a).forEach(r => {
            const idR = `rodada-${r}`;
            container.innerHTML += `
                <div class="rodada-container">
                    <button class="rodada-header" onclick="toggleRodada('${idR}', this)">
                        <span>RODADA ${r}</span>
                        <span class="seta">‚ñº</span>
                    </button>
                    <div id="${idR}" class="rodada-content">
                        ${rodadasAgrupadas[r].map(p => renderCard(p)).join('')}
                    </div>
                </div>`;
        });
    }

    function renderCard(p) {
        let statusColor = 'var(--primary)';
        if(p.status === 'GREEN') statusColor = 'var(--green)';
        if(p.status === 'RED') statusColor = 'var(--red)';
        if(p.status === 'AO VIVO') statusColor = 'var(--live)';
        
        const porcentagem = p.chance || 0;
        
        return `
            <div class="card" style="border-color: ${statusColor}88">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <span style="color:#8b949e; font-size:12px; font-weight:bold;">${p.horario || ''}</span>
                    <span style="background:${statusColor}; padding: 5px 12px; border-radius: 8px; font-size: 11px; font-weight: 900;">${p.status || 'ABERTO'}</span>
                </div>
                <h2 style="margin:10px 0; font-size:1.8rem; font-weight:900;">${p.jogo}</h2>
                <div class="entrada-box" style="border-left-color: ${statusColor}">
                    <div style="font-size:1.6rem; font-weight:900; color:white;">${p.entrada}</div>
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-top:5px;">
                        <b style="color:var(--green); font-size:1.3rem;">ODD ${p.odd}</b>
                        <span style="font-size:12px; font-weight:900; color:var(--primary-bright);">${porcentagem}% CHANCE</span>
                    </div>
                    <div class="radar-bar-bg"><div class="radar-bar-fill" style="width:${porcentagem}%"></div></div>
                </div>
                <button class="btn-toggle-analise" onclick="toggleAnalise('${p.id}', this)">üîç VER AN√ÅLISE</button>
                <div id="analise-${p.id}" class="analise-expansivel">
                    <p style="color:#8b949e; font-size:14px; line-height:1.6;">${p.analise || 'An√°lise VIP OddMax.'}</p>
                </div>
            </div>`;
    }

    function toggleRodada(id, btn) {
        const content = document.getElementById(id);
        const isVisible = content.style.display === 'flex';
        content.style.display = isVisible ? 'none' : 'flex';
        btn.querySelector('.seta').innerText = isVisible ? '‚ñº' : '‚ñ≤';
    }

    function toggleAnalise(id, btn) {
        const div = document.getElementById(`analise-${id}`);
        div.classList.toggle('show');
        btn.innerText = div.classList.contains('show') ? 'üîº FECHAR AN√ÅLISE' : 'üîç VER AN√ÅLISE';
    }

    function filtrarCamp(nome, btn) {
        document.querySelectorAll('.camp-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        campSelecionado = nome;
        filtrarGeral();
    }

    function filtrarStatus(status, btn) {
        document.querySelectorAll('.filter-tag').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        statusFiltro = status;
        filtrarGeral();
    }

    function limparFiltros() {
        campSelecionado = ""; statusFiltro = "TODOS";
        document.getElementById('inputBusca').value = "";
        document.querySelectorAll('.camp-btn, .filter-tag').forEach(b => b.classList.remove('active'));
        document.getElementById('filter-todos').classList.add('active');
        filtrarGeral();
    }

    function toggleSidebar() { document.getElementById('sidebar').classList.toggle('closed'); }
    function logout() { auth.signOut().then(() => { window.location.href = "login.html"; }); }
    function calcularStake() {
      const banca = document.getElementById('bancaValor').value;
      const ids = ['10','15','20','30','40','50'];
      ids.forEach(id => { document.getElementById('stake'+id).innerText = banca > 0 ? 'R$ ' + (banca * (id/100)).toFixed(2) : 'R$ 0,00'; });
    }
    function showNotification(j, e) {
        const container = document.getElementById('notification-container');
        const toast = document.createElement('div');
        toast.className = 'toast-alert';
        toast.innerHTML = `<div>üöÄ</div><div><div style="font-weight:900;">NOVO PALPITE!</div><div style="font-size:11px;">${j}</div></div>`;
        container.appendChild(toast);
        setTimeout(() => { toast.classList.add('fade-out'); setTimeout(() => toast.remove(), 500); }, 5000);
    }
  </script>
</body>
</html>